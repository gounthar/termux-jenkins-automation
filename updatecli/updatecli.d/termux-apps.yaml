---
name: Track Termux Application Versions

scms:
  default:
    kind: github
    spec:
      user: "{{ .github.user }}"
      email: "{{ .github.email }}"
      owner: "{{ .github.owner }}"
      repository: "{{ .github.repository }}"
      token: "{{ requiredEnv .github.token }}"
      username: "{{ .github.username }}"
      branch: "{{ .github.branch }}"

sources:
  default:
    kind: githubrelease
    spec:
      owner: "termux"
      token: "{{ requiredEnv .github.token }}"
      versionfilter:
        kind: semver
        pattern: "~0"  # Match any 0.x.x version, exclude pre-releases

  termuxApp:
    name: "Latest Termux App Version"
    spec:
      repository: "termux-app"

  termuxAPI:
    name: "Latest Termux:API Version"
    spec:
      repository: "termux-api"

  termuxBoot:
    name: "Latest Termux:Boot Version"
    spec:
      repository: "termux-boot"

conditions:
  default:
    kind: githubrelease
    spec:
      owner: "termux"
      token: "{{ requiredEnv .github.token }}"

  checkTermuxApp:
    name: "Verify Termux App release exists"
    sourceid: termuxApp
    spec:
      repository: "termux-app"

  checkTermuxAPI:
    name: "Verify Termux:API release exists"
    sourceid: termuxAPI
    spec:
      repository: "termux-api"

  checkTermuxBoot:
    name: "Verify Termux:Boot release exists"
    sourceid: termuxBoot
    spec:
      repository: "termux-boot"

targets:
  updateTermuxAppInReadme:
    name: "Update Termux App version in README.md"
    kind: file
    sourceid: termuxApp
    spec:
      file: README.md
      matchpattern: '(\[GitHub Releases\]\(https://github.com/termux/termux-app/releases\)) \(Latest: \[v[^\]]+\]\(https://github.com/termux/termux-app/releases/tag/v[^\)]+\)\)'
      replacepattern: '$1 (Latest: [v{{ source "termuxApp" }}](https://github.com/termux/termux-app/releases/tag/v{{ source "termuxApp" }}))'
    scmid: default

  updateTermuxAPIInReadme:
    name: "Update Termux:API version in README.md"
    kind: file
    sourceid: termuxAPI
    spec:
      file: README.md
      matchpattern: '(\[GitHub\]\(https://github.com/termux/termux-api/releases\)) \(Latest: \[v[^\]]+\]\(https://github.com/termux/termux-api/releases/tag/v[^\)]+\)\)'
      replacepattern: '$1 (Latest: [v{{ source "termuxAPI" }}](https://github.com/termux/termux-api/releases/tag/v{{ source "termuxAPI" }}))'
    scmid: default

  updateTermuxBootInReadme:
    name: "Update Termux:Boot version in README.md"
    kind: file
    sourceid: termuxBoot
    spec:
      file: README.md
      matchpattern: '(\[GitHub\]\(https://github.com/termux/termux-boot/releases\)) \(Latest: \[v[^\]]+\]\(https://github.com/termux/termux-boot/releases/tag/v[^\)]+\)\)'
      replacepattern: '$1 (Latest: [v{{ source "termuxBoot" }}](https://github.com/termux/termux-boot/releases/tag/v{{ source "termuxBoot" }}))'
    scmid: default

actions:
  default:
    kind: github/pullrequest
    scmid: default
    title: 'docs(deps): update Termux application versions in README'
    spec:
      labels:
        - dependencies
        - documentation
        - automation
      description: |
        ## Termux Application Version Updates

        This PR updates the Termux application version references in README.md.

        ### What's Changed
        - **Termux App**: [v{{ source "termuxApp" }}](https://github.com/termux/termux-app/releases/tag/v{{ source "termuxApp" }})
        - **Termux:API**: [v{{ source "termuxAPI" }}](https://github.com/termux/termux-api/releases/tag/v{{ source "termuxAPI" }})
        - **Termux:Boot**: [v{{ source "termuxBoot" }}](https://github.com/termux/termux-boot/releases/tag/v{{ source "termuxBoot" }})

        ### Why This Matters
        - Users can see the exact versions tested and recommended
        - Direct links to specific releases for easy downloading
        - Automated tracking ensures documentation stays current

        ### Testing
        Verify the links work correctly:
        - Check that version numbers render properly in README.md
        - Confirm GitHub release links are accessible
        - Validate that F-Droid links still work (maintained separately)

        ---
        *This PR was automatically generated by [UpdateCLI](https://www.updatecli.io/)*
