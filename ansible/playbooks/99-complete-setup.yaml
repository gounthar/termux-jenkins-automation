---
# Playbook: 99-complete-setup.yaml
# Purpose: Complete end-to-end Jenkins on Termux setup
# Usage: ansible-playbook -i ansible/inventory/hosts.yaml ansible/playbooks/99-complete-setup.yaml

- name: Complete Termux Jenkins Automation Setup
  hosts: localhost
  gather_facts: false
  become: false

  tasks:
    - name: Display welcome message
      ansible.builtin.debug:
        msg:
          - "╔════════════════════════════════════════════════════════╗"
          - "║   Termux Jenkins Automation - Complete Setup          ║"
          - "║   CloudNord Talk Demonstration                         ║"
          - "╚════════════════════════════════════════════════════════╝"
          - ""
          - "This playbook will:"
          - "  1. Set up Termux base environment"
          - "  2. Install Jenkins controller"
          - "  3. Configure Jenkins agent with build tools"
          - "  4. Apply Jenkins Configuration as Code"
          - "  5. Configure auto-start on boot (optional)"
          - ""
          - "Estimated time: 10-15 minutes"
          - "Press Ctrl+C to cancel, or wait to continue..."

    - name: Pause for review
      ansible.builtin.pause:
        seconds: 5

- name: Phase 1 - Set up Termux base
  ansible.builtin.import_playbook: 01-setup-termux.yaml

- name: Phase 2 - Install Jenkins controller
  ansible.builtin.import_playbook: 02-install-jenkins.yaml

- name: Phase 3 - Configure agent and build tools
  ansible.builtin.import_playbook: 03-configure-agent.yaml

- name: Phase 4 - Apply Jenkins Configuration as Code
  ansible.builtin.import_playbook: 04-configure-jcasc.yaml

- name: Phase 5 - Configure boot auto-start
  ansible.builtin.import_playbook: 05-configure-boot.yaml

- name: Final summary
  hosts: termux_controller
  gather_facts: false
  become: false

  tasks:
    - name: Display final summary
      ansible.builtin.debug:
        msg:
          - ""
          - "╔════════════════════════════════════════════════════════╗"
          - "║          🎉 Setup Complete!                            ║"
          - "╚════════════════════════════════════════════════════════╝"
          - ""
          - "Jenkins is now running on your Android device!"
          - ""
          - "📱 Access Information:"
          - "   URL: http://{{ ansible_host }}:{{ jenkins_port }}"
          - "   Login: {{ jenkins_admin_user }} / {{ jenkins_admin_password }}"
          - ""
          - "🚀 Try it out:"
          - "   1. Open Jenkins in your browser"
          - "   2. Run the 'hello-world' job"
          - "   3. Check the console output"
          - ""
          - "🔄 Auto-Start on Boot:"
          - "   Jenkins will start automatically when device reboots"
          - "   (if Termux:Boot is installed)"
          - ""
          - "📚 What's next?"
          - "   - Add more phones to your cluster"
          - "   - Create your own build jobs"
          - "   - Customize Jenkins Configuration as Code"
          - "   - Backup your configuration (backup-jenkins.yaml)"
          - ""
          - "📖 Documentation:"
          - "   - Repository: https://github.com/gounthar/termux-jenkins-automation"
          - "   - Boot Setup: ansible/roles/termux-boot-setup/README.md"
          - ""
          - "Thank you for trying CloudNord automation!"
